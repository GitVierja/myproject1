{"ast":null,"code":"import { EventEmitter } from \"@angular/core\";\nimport { switchMap, takeUntil } from \"rxjs/operators\";\nimport { EMPTY, Subject } from \"rxjs\";\nimport { NgClass } from \"@angular/common\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../core/services/profile.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"../../core/services/user.service\";\nconst _c0 = function (a0, a1, a2) {\n  return {\n    disabled: a0,\n    \"btn-outline-secondary\": a1,\n    \"btn-secondary\": a2\n  };\n};\nexport class FollowButtonComponent {\n  constructor(profileService, router, userService) {\n    this.profileService = profileService;\n    this.router = router;\n    this.userService = userService;\n    this.toggle = new EventEmitter();\n    this.isSubmitting = false;\n    this.destroy$ = new Subject();\n  }\n  ngOnDestroy() {\n    this.destroy$.next();\n    this.destroy$.complete();\n  }\n  toggleFollowing() {\n    this.isSubmitting = true;\n    this.userService.isAuthenticated.pipe(switchMap(isAuthenticated => {\n      if (!isAuthenticated) {\n        void this.router.navigate([\"/login\"]);\n        return EMPTY;\n      }\n      if (!this.profile.following) {\n        return this.profileService.follow(this.profile.username);\n      } else {\n        return this.profileService.unfollow(this.profile.username);\n      }\n    }), takeUntil(this.destroy$)).subscribe({\n      next: profile => {\n        this.isSubmitting = false;\n        this.toggle.emit(profile);\n      },\n      error: () => this.isSubmitting = false\n    });\n  }\n  static #_ = this.ɵfac = function FollowButtonComponent_Factory(t) {\n    return new (t || FollowButtonComponent)(i0.ɵɵdirectiveInject(i1.ProfileService), i0.ɵɵdirectiveInject(i2.Router), i0.ɵɵdirectiveInject(i3.UserService));\n  };\n  static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: FollowButtonComponent,\n    selectors: [[\"app-follow-button\"]],\n    inputs: {\n      profile: \"profile\"\n    },\n    outputs: {\n      toggle: \"toggle\"\n    },\n    standalone: true,\n    features: [i0.ɵɵStandaloneFeature],\n    decls: 3,\n    vars: 7,\n    consts: [[1, \"btn\", \"btn-sm\", \"action-btn\", 3, \"ngClass\", \"click\"], [1, \"ion-plus-round\"]],\n    template: function FollowButtonComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"button\", 0);\n        i0.ɵɵlistener(\"click\", function FollowButtonComponent_Template_button_click_0_listener() {\n          return ctx.toggleFollowing();\n        });\n        i0.ɵɵelement(1, \"i\", 1);\n        i0.ɵɵtext(2);\n        i0.ɵɵelementEnd();\n      }\n      if (rf & 2) {\n        i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction3(3, _c0, ctx.isSubmitting, !ctx.profile.following, ctx.profile.following));\n        i0.ɵɵadvance(2);\n        i0.ɵɵtextInterpolate2(\" \\u00A0 \", ctx.profile.following ? \"Unfollow\" : \"Follow\", \" \", ctx.profile.username, \"\\n\");\n      }\n    },\n    dependencies: [NgClass],\n    encapsulation: 2\n  });\n}","map":{"version":3,"names":["EventEmitter","switchMap","takeUntil","EMPTY","Subject","NgClass","FollowButtonComponent","constructor","profileService","router","userService","toggle","isSubmitting","destroy$","ngOnDestroy","next","complete","toggleFollowing","isAuthenticated","pipe","navigate","profile","following","follow","username","unfollow","subscribe","emit","error","_","i0","ɵɵdirectiveInject","i1","ProfileService","i2","Router","i3","UserService","_2","selectors","inputs","outputs","standalone","features","ɵɵStandaloneFeature","decls","vars","consts","template","FollowButtonComponent_Template","rf","ctx","ɵɵelementStart","ɵɵlistener","FollowButtonComponent_Template_button_click_0_listener","ɵɵelement","ɵɵtext","ɵɵelementEnd","ɵɵproperty","ɵɵpureFunction3","_c0","ɵɵadvance","ɵɵtextInterpolate2","encapsulation"],"sources":["C:\\Users\\javie\\KarateGit\\myproject\\src\\app\\shared\\buttons\\follow-button.component.ts","C:\\Users\\javie\\KarateGit\\myproject\\src\\app\\shared\\buttons\\follow-button.component.html"],"sourcesContent":["import {\r\n  Component,\r\n  EventEmitter,\r\n  Input,\r\n  OnDestroy,\r\n  Output,\r\n} from \"@angular/core\";\r\nimport { Router } from \"@angular/router\";\r\nimport { switchMap, takeUntil } from \"rxjs/operators\";\r\nimport { EMPTY, Subject } from \"rxjs\";\r\nimport { ProfileService } from \"../../core/services/profile.service\";\r\nimport { UserService } from \"../../core/services/user.service\";\r\nimport { Profile } from \"../../core/models/profile.model\";\r\nimport { NgClass } from \"@angular/common\";\r\n\r\n@Component({\r\n  selector: \"app-follow-button\",\r\n  templateUrl: \"./follow-button.component.html\",\r\n  imports: [NgClass],\r\n  standalone: true,\r\n})\r\nexport class FollowButtonComponent implements OnDestroy {\r\n  @Input() profile!: Profile;\r\n  @Output() toggle = new EventEmitter<Profile>();\r\n  isSubmitting = false;\r\n  destroy$ = new Subject<void>();\r\n\r\n  constructor(\r\n    private readonly profileService: ProfileService,\r\n    private readonly router: Router,\r\n    private readonly userService: UserService\r\n  ) {}\r\n\r\n  ngOnDestroy(): void {\r\n    this.destroy$.next();\r\n    this.destroy$.complete();\r\n  }\r\n\r\n  toggleFollowing(): void {\r\n    this.isSubmitting = true;\r\n\r\n    this.userService.isAuthenticated\r\n      .pipe(\r\n        switchMap((isAuthenticated: boolean) => {\r\n          if (!isAuthenticated) {\r\n            void this.router.navigate([\"/login\"]);\r\n            return EMPTY;\r\n          }\r\n\r\n          if (!this.profile.following) {\r\n            return this.profileService.follow(this.profile.username);\r\n          } else {\r\n            return this.profileService.unfollow(this.profile.username);\r\n          }\r\n        }),\r\n        takeUntil(this.destroy$)\r\n      )\r\n      .subscribe({\r\n        next: (profile) => {\r\n          this.isSubmitting = false;\r\n          this.toggle.emit(profile);\r\n        },\r\n        error: () => (this.isSubmitting = false),\r\n      });\r\n  }\r\n}\r\n","<button\r\n  class=\"btn btn-sm action-btn\"\r\n  [ngClass]=\"{\r\n    disabled: isSubmitting,\r\n    'btn-outline-secondary': !profile.following,\r\n    'btn-secondary': profile.following\r\n  }\"\r\n  (click)=\"toggleFollowing()\"\r\n>\r\n  <i class=\"ion-plus-round\"></i>\r\n  &nbsp;\r\n  {{ profile.following ? \"Unfollow\" : \"Follow\" }} {{ profile.username }}\r\n</button>\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}